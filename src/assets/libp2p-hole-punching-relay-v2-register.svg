<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="672.5044px" preserveAspectRatio="none" style="width:1288px;height:672px;" version="1.1" viewBox="0 0 1288 672" width="1288.9667px" zoomAndPan="magnify"><defs><filter height="300%" id="f1j99tjwl2m91v" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="4.483362521891419"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="8.966725043782837" dy="8.966725043782837" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1j99tjwl2m91v)" height="403.345" style="stroke: #000000; stroke-width: 4.483362521891419;" width="1235.1664" x="29.1419" y="132.9247"/><rect fill="#FFFFFF" filter="url(#f1j99tjwl2m91v)" height="234.3257" style="stroke: #000000; stroke-width: 4.483362521891419;" width="957.1979" x="51.5587" y="187.0228"/><line style="stroke: #A80036; stroke-width: 2.2416812609457093; stroke-dasharray: 5.0,5.0;" x1="105.359" x2="105.359" y1="94.8161" y2="574.3783"/><line style="stroke: #A80036; stroke-width: 2.2416812609457093; stroke-dasharray: 5.0,5.0;" x1="452.8196" x2="452.8196" y1="94.8161" y2="574.3783"/><line style="stroke: #A80036; stroke-width: 2.2416812609457093; stroke-dasharray: 5.0,5.0;" x1="1120.8406" x2="1120.8406" y1="94.8161" y2="574.3783"/><rect fill="#FEFECE" filter="url(#f1j99tjwl2m91v)" height="67.9159" style="stroke: #A80036; stroke-width: 3.362521891418564;" width="53.8004" x="73.9755" y="15.6918"/><text fill="#000000" font-family="sans-serif" font-size="31.3835" lengthAdjust="spacingAndGlyphs" textLength="22.4168" x="89.6673" y="60.5144">R</text><rect fill="#FEFECE" filter="url(#f1j99tjwl2m91v)" height="67.9159" style="stroke: #A80036; stroke-width: 3.362521891418564;" width="53.8004" x="73.9755" y="572.1366"/><text fill="#000000" font-family="sans-serif" font-size="31.3835" lengthAdjust="spacingAndGlyphs" textLength="22.4168" x="89.6673" y="616.9593">R</text><rect fill="#FEFECE" filter="url(#f1j99tjwl2m91v)" height="67.9159" style="stroke: #A80036; stroke-width: 3.362521891418564;" width="53.8004" x="421.4361" y="15.6918"/><text fill="#000000" font-family="sans-serif" font-size="31.3835" lengthAdjust="spacingAndGlyphs" textLength="22.4168" x="437.1278" y="60.5144">B</text><rect fill="#FEFECE" filter="url(#f1j99tjwl2m91v)" height="67.9159" style="stroke: #A80036; stroke-width: 3.362521891418564;" width="53.8004" x="421.4361" y="572.1366"/><text fill="#000000" font-family="sans-serif" font-size="31.3835" lengthAdjust="spacingAndGlyphs" textLength="22.4168" x="437.1278" y="616.9593">B</text><rect fill="#FEFECE" filter="url(#f1j99tjwl2m91v)" height="67.9159" style="stroke: #A80036; stroke-width: 3.362521891418564;" width="224.1681" x="1008.7566" y="6.725"/><rect fill="#FEFECE" filter="url(#f1j99tjwl2m91v)" height="67.9159" style="stroke: #A80036; stroke-width: 3.362521891418564;" width="224.1681" x="999.7898" y="15.6918"/><text fill="#000000" font-family="sans-serif" font-size="31.3835" lengthAdjust="spacingAndGlyphs" textLength="192.7846" x="1015.4816" y="60.5144">Other_Peers</text><rect fill="#FEFECE" filter="url(#f1j99tjwl2m91v)" height="67.9159" style="stroke: #A80036; stroke-width: 3.362521891418564;" width="224.1681" x="1008.7566" y="572.1366"/><rect fill="#FEFECE" filter="url(#f1j99tjwl2m91v)" height="67.9159" style="stroke: #A80036; stroke-width: 3.362521891418564;" width="224.1681" x="999.7898" y="581.1033"/><text fill="#000000" font-family="sans-serif" font-size="31.3835" lengthAdjust="spacingAndGlyphs" textLength="192.7846" x="1015.4816" y="625.926">Other_Peers</text><path d="M29.1419,132.9247 L1019.965,132.9247 L1019.965,148.6165 L997.5482,171.0333 L29.1419,171.0333 L29.1419,132.9247 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 2.2416812609457093;"/><rect fill="none" height="403.345" style="stroke: #000000; stroke-width: 4.483362521891419;" width="1235.1664" x="29.1419" y="132.9247"/><text fill="#000000" font-family="sans-serif" font-size="29.1419" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="889.9475" x="62.7671" y="162.2165">B listening for incoming connections via closest Relay</text><path d="M51.5587,187.0228 L997.5482,187.0228 L997.5482,202.7145 L975.1313,225.1313 L51.5587,225.1313 L51.5587,187.0228 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 2.2416812609457093;"/><rect fill="none" height="234.3257" style="stroke: #000000; stroke-width: 4.483362521891419;" width="957.1979" x="51.5587" y="187.0228"/><text fill="#000000" font-family="sans-serif" font-size="29.1419" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="845.1138" x="85.1839" y="216.3146">For each closest Relay via Circuit Relay v2 Protocol</text><polygon fill="#A80036" points="130.0175,263.8354,107.6007,272.8021,130.0175,281.7688,121.0508,272.8021" style="stroke: #A80036; stroke-width: 2.2416812609457093;"/><line style="stroke: #A80036; stroke-width: 2.2416812609457093;" x1="116.5674" x2="450.5779" y1="272.8021" y2="272.8021"/><text fill="#000000" font-family="sans-serif" font-size="29.1419" lengthAdjust="spacingAndGlyphs" textLength="293.6602" x="143.4676" y="261.4459">Establish connection</text><polygon fill="#A80036" points="130.0175,329.1419,107.6007,338.1086,130.0175,347.0753,121.0508,338.1086" style="stroke: #A80036; stroke-width: 2.2416812609457093;"/><line style="stroke: #A80036; stroke-width: 2.2416812609457093;" x1="116.5674" x2="450.5779" y1="338.1086" y2="338.1086"/><text fill="#000000" font-family="sans-serif" font-size="29.1419" lengthAdjust="spacingAndGlyphs" textLength="286.9352" x="143.4676" y="326.7524">Request reservation</text><polygon fill="#A80036" points="425.9194,394.4483,448.3363,403.4151,425.9194,412.3818,434.8862,403.4151" style="stroke: #A80036; stroke-width: 2.2416812609457093;"/><line style="stroke: #A80036; stroke-width: 2.2416812609457093;" x1="105.359" x2="439.3695" y1="403.4151" y2="403.4151"/><text fill="#000000" font-family="sans-serif" font-size="29.1419" lengthAdjust="spacingAndGlyphs" textLength="269.0018" x="121.0508" y="392.0589">Accept reservation</text><polygon fill="#A80036" points="1093.9405,509.3695,1116.3573,518.3363,1093.9405,527.303,1102.9072,518.3363" style="stroke: #A80036; stroke-width: 2.2416812609457093;"/><line style="stroke: #A80036; stroke-width: 2.2416812609457093;" x1="452.8196" x2="1107.3905" y1="518.3363" y2="518.3363"/><text fill="#000000" font-family="sans-serif" font-size="29.1419" lengthAdjust="spacingAndGlyphs" textLength="289.1769" x="468.5114" y="473.0571">Advertise oneself as</text><text fill="#000000" font-family="sans-serif" font-size="29.1419" lengthAdjust="spacingAndGlyphs" textLength="614.2207" x="468.5114" y="506.9801">/&lt;RELAY_ADDR&gt;/p2p-circuit/&lt;PEER_ID_B&gt;</text><!--MD5=[3a6f65afab49128d5ae5dffccccf3c37]
@startuml
scale 1280 width
participant R
participant B
collections Other_Peers

group B listening for incoming connections via closest Relay
        group For each closest Relay via Circuit Relay v2 Protocol
                B -> R: Establish connection
                B -> R: Request reservation
                R -> B: Accept reservation
        end
        B -> Other_Peers: Advertise oneself as\n/<RELAY_ADDR>/p2p-circuit/<PEER_ID_B>
end

@enduml

PlantUML version 1.2020.02(Sun Mar 01 11:22:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.14+9-post-Debian-1deb11u1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>